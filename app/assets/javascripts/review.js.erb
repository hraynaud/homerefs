$(function() {
  $('.slider').slider();
});

var fieldArray = <%=ReviewMetadata.all.map(&:field_name)%>
var fieldArrayIds = [];

fieldArray.forEach(function(item){
  fieldArrayIds.push("#"+item)
  });

function updateValues(){
  $(".ui-slider").each(function(){
    var sliderId = $(this).attr("id")
    if ($("#_"+sliderId).length) {
    $("#_"+sliderId).val($(this).slider("value"))
    }
  })

};

function submitWithAjax() {
  updateValues();
  $.post(this.action, $(this.serialize(), null, "script"));
  return false;
}


$("#new_review").bind('submit', submitWithAjax);

$(function() {
  fieldArray.forEach(function(item){
    $("#new_review").append("<input type='hidden' name='review[" + item + "]', id='_" + item + "'>");
  });

  fieldArrayIds.forEach(function(item){
    $(item).slider({
   range: "min",
   min: 1,
   max: 5,
   value: 3
    });
  });
});
 /*
  $( "#cleanliness, #pests, #sunlight, #prox_mass_transit, #noise_level, #ceilings, #closet_space, #intercom_system, #temp_control, #appliances, #countertops, #floors, #bathrooms, #walls, #utilities, #neighbors, #laundry, #mass_transit, #neighborhood, #storage, #packages, #super"
   ).slider({
     range: "min",
     min: 1,
     max: 5,
     value: 3
   });*/

